(self.webpackChunkgofn=self.webpackChunkgofn||[]).push([[291],{5318:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},5503:function(e,n,t){"use strict";var a=t(5318);n.Z=void 0;var i=a(t(4938)),l=t(5893),r=(0,i.default)((0,l.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");n.Z=r},813:function(e,n,t){"use strict";var a=t(5318);n.Z=void 0;var i=a(t(4938)),l=t(5893),r=(0,i.default)((0,l.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");n.Z=r},1462:function(e,n,t){"use strict";var a=t(5318);n.Z=void 0;var i=a(t(4938)),l=t(5893),r=(0,i.default)([(0,l.jsx)("path",{d:"M6 17.59 7.41 19 12 14.42 16.59 19 18 17.59l-6-6z"},"0"),(0,l.jsx)("path",{d:"m6 11 1.41 1.41L12 7.83l4.59 4.58L18 11l-6-6z"},"1")],"KeyboardDoubleArrowUp");n.Z=r},4938:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return a.createSvgIcon}});var a=t(218)},218:function(e,n,t){"use strict";t.r(n),t.d(n,{capitalize:function(){return i.Z},createChainedFunction:function(){return l},createSvgIcon:function(){return r.Z},debounce:function(){return o},deprecatedPropType:function(){return s},isMuiElement:function(){return m},ownerDocument:function(){return k},ownerWindow:function(){return c},requirePropFactory:function(){return f},setRef:function(){return h},unstable_ClassNameGenerator:function(){return T},unstable_useEnhancedEffect:function(){return N},unstable_useId:function(){return C},unsupportedProp:function(){return v},useControlled:function(){return b.Z},useEventCallback:function(){return I.Z},useForkRef:function(){return w.Z},useIsFocusVisible:function(){return y.Z}});var a=t(7078),i=t(8216);var l=function(...e){return e.reduce(((e,n)=>null==n?e:function(...t){e.apply(this,t),n.apply(this,t)}),(()=>{}))},r=t(8169);var o=function(e,n=166){let t;function a(...a){clearTimeout(t),t=setTimeout((()=>{e.apply(this,a)}),n)}return a.clear=()=>{clearTimeout(t)},a};var s=function(e,n){return()=>null},d=t(7294),p=t.t(d,2);var m=function(e,n){return d.isValidElement(e)&&-1!==n.indexOf(e.type.muiName)};function u(e){return e&&e.ownerDocument||document}var k=u;var c=function(e){return u(e).defaultView||window};t(7462);var f=function(e,n){return()=>null},h=t(7960).Z,N=t(6600).Z;let g=0;const R=p.useId;var C=function(e){if(void 0!==R){const n=R();return null!=e?e:n}return function(e){const[n,t]=d.useState(e),a=e||n;return d.useEffect((()=>{null==n&&(g+=1,t(`mui-${g}`))}),[n]),a}(e)};var v=function(e,n,t,a,i){return null},b=t(2627),I=t(9327),w=t(8031),y=t(8791);const T={configure:e=>{console.warn(["MUI: `ClassNameGenerator` import from `@mui/material/utils` is outdated and might cause unexpected issues.","","You should use `import { unstable_ClassNameGenerator } from '@mui/material/className'` instead","","The detail of the issue: https://github.com/mui/material-ui/issues/30011#issuecomment-1024993401","","The updated documentation: https://mui.com/guides/classname-generator/"].join("\n")),a.Z.configure(e)}}},4685:function(e,n,t){"use strict";t.r(n),t.d(n,{HighRating:function(){return g},LowRating:function(){return R},MidRating:function(){return N},assets:function(){return f},contentTitle:function(){return k},default:function(){return v},frontMatter:function(){return u},metadata:function(){return c},toc:function(){return h}});var a=t(7462),i=t(3366),l=(t(7294),t(3905)),r=t(3486),o=t(265),s=t(1462),d=t(813),p=t(5503),m=["components"],u={title:"Simple Go"},k=void 0,c={unversionedId:"comparisons/simple/index",id:"comparisons/simple/index",title:"Simple Go",description:"Example Files",source:"@site/content/900-comparisons/100-simple/index.mdx",sourceDirName:"900-comparisons/100-simple",slug:"/comparisons/simple/",permalink:"/comparisons/simple/",draft:!1,tags:[],version:"current",frontMatter:{title:"Simple Go"},sidebar:"tutorialSidebar",previous:{title:"Comparisons & Examples",permalink:"/comparisons/"}},f={},h=[{value:"Example Files",id:"example-files",level:2},{value:"<code>Makefile</code>",id:"makefile",level:3},{value:"<code>Taskfile.yml</code>",id:"taskfileyml",level:3},{value:"<code>fnfile.yml</code>",id:"fnfileyml",level:3},{value:"Criteria",id:"criteria",level:2},{value:"Clarity/Readability",id:"clarityreadability",level:3},{value:"Dependencies",id:"dependencies",level:4},{value:"Variable Assignments &amp; Use",id:"variable-assignments--use",level:4},{value:"Error Handling",id:"error-handling",level:4},{value:"Maintainability",id:"maintainability",level:3},{value:"Lines of code",id:"lines-of-code",level:3},{value:"Conclusion",id:"conclusion",level:2}],N=function(e){var n=e.children;return(0,l.kt)(d.Z,{sx:{color:r.Z[500]},mdxType:"KeyboardArrowUpIcon"},n)},g=function(e){var n=e.children;return(0,l.kt)(s.Z,{sx:{color:r.Z[500]},mdxType:"KeyboardDoubleArrowUpIcon"},n)},R=function(e){var n=e.children;return(0,l.kt)(p.Z,{sx:{color:o.Z[500]},mdxType:"KeyboardArrowDownIcon"},n)},C={toc:h,MidRating:N,HighRating:g,LowRating:R};function v(e){var n=e.components,t=(0,i.Z)(e,m);return(0,l.kt)("wrapper",(0,a.Z)({},C,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"example-files"},"Example Files"),(0,l.kt)("h3",{id:"makefile"},(0,l.kt)("inlineCode",{parentName:"h3"},"Makefile")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"# Borrowed from:\n# https://gist.github.com/turtlemonvh/38bd3d73e61769767c35931d8c70ccb4\n# Which borrowed from\n# https://github.com/silven/go-example/blob/master/Makefile\n# https://vic.demuzere.be/articles/golang-makefile-crosscompile/\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Makefile"',title:'"Makefile"'},'BINARY      := superdo\nVET_REPORT  := vet.report\nTEST_REPORT := tests.xml\nGOARCH      := amd64\n\nVERSION ?= ?\nCOMMIT  := $(shell git rev-parse HEAD)\nBRANCH  := $(shell git rev-parse --abbrev-ref HEAD)\n\nGITHUB_USERNAME := turtlemonvh\nBUILD_DIR       := ${GOPATH}/src/github.com/${GITHUB_USERNAME}/${BINARY}\nCURRENT_DIR     := $(shell pwd)\nBUILD_DIR_LINK  := $(shell readlink ${BUILD_DIR})\n\nLDFLAGS := -ldflags "-X main.VERSION=${VERSION} -X main.COMMIT=${COMMIT} -X main.BRANCH=${BRANCH}"\n\n.PHONY: %\n\nall: link clean test vet build\n\nlink:\n    if [ "${BUILD_DIR_LINK}" != "${CURRENT_DIR}" ]; then \\\n        echo "Fixing symlinks for build"; \\\n        rm -f ${BUILD_DIR}; \\\n        ln -s ${CURRENT_DIR} ${BUILD_DIR}; \\\n    fi\n\nbuild: build.linux build.darwin build.windows\n\nbuild.linux:\n    cd ${BUILD_DIR}; \\\n    GOOS=linux GOARCH=${GOARCH} \\\n      go build ${LDFLAGS} -o ${BINARY}-linux-${GOARCH} .\n\nbuild.darwin:\n    cd ${BUILD_DIR}; \\\n    GOOS=darwin GOARCH=${GOARCH} \\\n      go build ${LDFLAGS} -o ${BINARY}-darwin-${GOARCH} .\n\nbuild.windows:\n    cd ${BUILD_DIR}; \\\n    GOOS=windows GOARCH=${GOARCH} \\\n      go build ${LDFLAGS} -o ${BINARY}-windows-${GOARCH}.exe .\n\ntest:\n    if ! hash go2xunit 2>/dev/null; then go install github.com/tebeka/go2xunit; fi\n    cd ${BUILD_DIR}; \\\n    go test -v ./... 2>&1 | go2xunit -output ${TEST_REPORT}\n\nvet:\n    cd ${BUILD_DIR}; \\\n    go vet ./... > ${VET_REPORT} 2>&1\n\nfmt:\n    cd ${BUILD_DIR}; \\\n    go fmt $$(go list ./... | grep -v /vendor/)\n\nclean:\n    -rm -f ${TEST_REPORT}\n    -rm -f ${VET_REPORT}\n    -rm -f ${BINARY}-*\n')),(0,l.kt)("h3",{id:"taskfileyml"},(0,l.kt)("inlineCode",{parentName:"h3"},"Taskfile.yml")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="Taskfile.yml"',title:'"Taskfile.yml"'},'version: "3"\nvars:\n  BINARY: superdo\n  VET_REPORT: vet.report\n  TEST_REPORT: tests.xml\n\n  VERSION: \'{{env VERSION | default "?"}}\'\n  COMMIT:\n    sh: git rev-parse HEAD\n  BRANCH:\n    sh: git rev-parse --abbrev-ref HEAD\n\n  GITHUB_USERNAME: turtlemonvh\n  BUILD_DIR: \'{{expandenv "${GOPATH}/src/github.com/${GITHUB_USERNAME}/${BINARY}"}}\'\n  CURRENT_DIR:\n    sh: pwd\n  BUILD_DIR_LINK:\n    sh: readlink "{{.BUILD_DIR}}"\n\nenv:\n  GOARCH: amd64\n  LDFLAGS: -ldflags "-X main.VERSION={{.VERSION}} -X main.COMMIT={{.COMMIT}} -X main.BRANCH={{.BRANCH}}"\n\ntasks:\n  all:\n    cmds: [{ task: link }, { task: clean }, { task: test }, { task: vet }, { task: build }]\n\n  link:\n    status:\n    - [ "{{.BUILD_DIR_LINK}}" != "{{.CURRENT_DIR}}" ]\n    cmds:\n    - echo "Fixing symlinks for build"\n    - rm -f "{{.BUILD_DIR}}\n    - ln -s "{{.CURRENT_DIR}} {{.BUILD_DIR}}\n\n  build:\n    cmds: [{ task: build:linux }, { task: build:darwin }, { task: build:windows }]\n\n  build:os:\n    vars:\n      GOOS: \'{{.GOOS | default "linux"}}\'\n      BINARY_EXT: \'{{.BINARY_EXT | default ""}}\'\n    dir: "{{.BUILD_DIR}}"\n    cmds:\n    - |-\n      GOOS={{.GOOS}} GOARCH={{.GOARCH}} \\\n      go build {{.LDFLAGS}} -o {{.BINARY}}-{{.GOOS}}-{{.GOARCH}}{{.BINARY_EXT}} .\n\n  build:linux:\n    cmds:\n    - task: build:os\n      vars:\n        GOOS: linux\n\n  build:darwin:\n    cmds:\n    - task: build:os\n      vars:\n        GOOS: darwin\n\n  build:windows:\n    cmds:\n    - task: build:os\n      vars:\n        GOOS: windows\n        BINARY_EXT: ".exe"\n\n  test:\n    cmds:\n    - if ! hash go2xunit 2>/dev/null; then go install github.com/tebeka/go2xunit; fi\n    - |-\n      cd ${BUILD_DIR}; \\\n      go test -v ./... 2>&1 | go2xunit -output ${TEST_REPORT} ;\n\n  vet:\n    dir: "{{.BUILD_DIR}}"\n    cmds:\n    - go vet ./... > "{{.VET_REPORT}} 2>&1\n\n  fmt:\n    dir: "{{.BUILD_DIR}}"\n    cmds:\n    - go fmt ./...\n\n  clean:\n    dir: "{{.BUILD_DIR}}"\n    ignore_error: true\n    cmds:\n    - rm -f "{{.TEST_REPORT}}"\n    - rm -f "{{.VET_REPORT}}"\n    - rm -f "{{.BINARY}}-*"\n')),(0,l.kt)("h3",{id:"fnfileyml"},(0,l.kt)("inlineCode",{parentName:"h3"},"fnfile.yml")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="fnfile.yml"',title:'"fnfile.yml"'},'version: "0.1"\nvars:\n  BINARY: superdo\n  VET_REPORT: vet.report\n  TEST_REPORT: tests.xml\n\n  VERSION: \'{{env VERSION | default "?"}}\'\n  COMMIT:\n    sh: git rev-parse HEAD\n  BRANCH:\n    sh: git rev-parse --abbrev-ref HEAD\n\n  GITHUB_USERNAME: turtlemonvh\n  BUILD_DIR: \'{{expandenv "${GOPATH}/src/github.com/${GITHUB_USERNAME}/${BINARY}"}}\'\n  CURRENT_DIR:\n    sh: pwd\n  BUILD_DIR_LINK:\n    sh: readlink {{.BUILD_DIR}}\n\nenv:\n  GOARCH: amd64\n  LDFLAGS: -ldflags "-X main.VERSION={{.VERSION}} -X main.COMMIT={{.COMMIT}} -X main.BRANCH={{.BRANCH}}"\n\nfns:\n  all:\n    do: [{ fn: link }, { fn: clean }, { fn: test }, { fn: vet }, { fn: build:os }]\n\n  link:\n    do:\n    - if:\n        cond: \'[ "{{.V "BUILD_DIR_LINK"}}" != "{{.V "CURRENT_DIR"}}" ]\'\n        return:\n    - echo "Fixing symlinks for build"\n    - rm -f "{{.V "BUILD_DIR"}}\n    - ln -s "{{.V "CURRENT_DIR"}} {{.V "BUILD_DIR"}}\n\n  build:\n    matrix:\n      kvs:\n        GOOS: [linux, darwin, windows]\n    dir: \'{{.V "BUILD_DIR"}}\'\n    vars:\n      BINARY_EXT: \'{{eq (.V "GOOS") "windows" | ternary ".exe" ""}}\'\n    do: |-\n      GOOS={{.V "GOOS"}} GOARCH={{.V "GOARCH"}} \\\n      go build {{.V "LDFLAGS"}} -o {{.V "BINARY"}}-{{.V "GOOS"}}-{{.V "GOARCH"}}{{.V "BINARY_EXT"}} .\n\n  test:\n  - if ! hash go2xunit 2>/dev/null; then go install github.com/tebeka/go2xunit; fi\n  - sh: go test -v ./... 2>&1 | go2xunit -output ${TEST_REPORT}\n    dir: \'{{.V "BUILD_DIR"}}\'\n\n  vet:\n    dir: \'{{.V "BUILD_DIR"}}\'\n    do: go vet ./... > "{{.V "VET_REPORT"}}" 2>&1\n\n  fmt:\n    dir: \'{{.V "BUILD_DIR"}}\'\n    do: go fmt ./...\n\n  clean:\n    dir: \'{{.V "BUILD_DIR"}}\'\n    matrix:\n      file: [ "{{.V "TEST_REPORT"}}", "{{.V "VET_REPORT"}}", "{{.V "BINARY"}}-*" ]\n    do:\n    - sh:\n        run: rm -f "{{.Matrix.file}}"\n        onError: continue\n')),(0,l.kt)("h2",{id:"criteria"},"Criteria"),(0,l.kt)("h3",{id:"clarityreadability"},"Clarity/Readability"),(0,l.kt)("p",null,"This particular ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile")," isn't very long or using many advanced/confusing features or syntax, so personally, I think this Makefile is quite good."),(0,l.kt)("h4",{id:"dependencies"},"Dependencies"),(0,l.kt)("p",null,"So far so good, but if you are familiar with ",(0,l.kt)("inlineCode",{parentName:"p"},"task")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"make"),", you may be asking yourself why I wrote the ",(0,l.kt)("inlineCode",{parentName:"p"},"Taskfile.yml")," with this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"  all:\n    cmds: [{ task: link }, { task: clean }, { task: test }, { task: vet }, { task: build }]\n  # ...\n  build:\n    cmds: [ {task: linux}, {task: darwin}, {task: windows}]\n")),(0,l.kt)("p",null,"instead of"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"  all:\n    deps: [link, clean, test, vet, build]\n  # ...\n  build:\n    deps: [linux, darwin, windows]\n")),(0,l.kt)("p",null,"In short, I wanted to translate the original ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile")," as accurately as possible."),(0,l.kt)("p",null,"Without looking at ",(0,l.kt)("a",{parentName:"p",href:"https://taskfile.dev/usage/#task-dependencies"},"the documentation"),", do you know what the difference is between ",(0,l.kt)("inlineCode",{parentName:"p"},"deps")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"cmds"),"?"),(0,l.kt)("p",null,"Do you know how ",(0,l.kt)("inlineCode",{parentName:"p"},"make")," ",(0,l.kt)("a",{parentName:"p",href:"https://www.gnu.org/software/make/manual/html_node/Parallel.html#Parallel"},"processes dependencies")," such as in snippet below?"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"all: link clean test vet build\n")),(0,l.kt)("p",null,"Finally, if I showed you this snippet, would you know what's going on?"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"do: [ { fn: link }, { fn: clean }, { fn: test }, { fn: vet }, { fn: build } ]\n# vs\nparallel: [ { fn: link }, { fn: clean }, { fn: test }, { fn: vet }, { fn: build } ]\n")),(0,l.kt)("p",null,"If you got this far without being tempted to click on the links, I'll fill you in:"),(0,l.kt)("p",null,"In a ",(0,l.kt)("inlineCode",{parentName:"p"},"Taskfile"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"deps")," are a list of other ",(0,l.kt)("inlineCode",{parentName:"p"},"task")," names, run in parallel and ",(0,l.kt)("inlineCode",{parentName:"p"},"cmds")," are shell commands (if the value is a string), run serially. If you wish to run a ",(0,l.kt)("inlineCode",{parentName:"p"},"task")," instead of shell command for a particular step in the ",(0,l.kt)("inlineCode",{parentName:"p"},"cmds")," array, you can switch to using object notation, and then provide a ",(0,l.kt)("inlineCode",{parentName:"p"},"task")," key and set the value to the name of the task, e.g. ",(0,l.kt)("inlineCode",{parentName:"p"},'task: "link"'),". The name ",(0,l.kt)("inlineCode",{parentName:"p"},"deps")," is short for ",(0,l.kt)("inlineCode",{parentName:"p"},"dependencies"),", which at least provides relative ordering information between ",(0,l.kt)("inlineCode",{parentName:"p"},"cmds")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"deps"),". Neither ",(0,l.kt)("inlineCode",{parentName:"p"},"cmds")," nor ",(0,l.kt)("inlineCode",{parentName:"p"},"deps")," provide ",(0,l.kt)("em",{parentName:"p"},"signifiers")," for parallelism."),(0,l.kt)("p",null,"In a ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile"),", by default, target dependencies run ",(0,l.kt)("inlineCode",{parentName:"p"},"serially"),". But this changes if you provide the ",(0,l.kt)("inlineCode",{parentName:"p"},"-j")," commandline option (affecting all targets in a ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile"),"). Furthermore, you can set a pseudo-target ",(0,l.kt)("inlineCode",{parentName:"p"},".NOTPARALLEL")," to inhibit parallelism for the entire makefile (regardless of whether ",(0,l.kt)("inlineCode",{parentName:"p"},"-j")," is passed or not). ",(0,l.kt)("inlineCode",{parentName:"p"},"make")," does not support parallelism for individual target dependencies. There are no ",(0,l.kt)("em",{parentName:"p"},"signifiers")," for parallelism in task, and without an explicit ",(0,l.kt)("inlineCode",{parentName:"p"},".NOTPARALLEL")," defined, a user could run ",(0,l.kt)("inlineCode",{parentName:"p"},"make "),"-j`, thus changing the behavior, and likely causing unforeseen problems from race conditions."),(0,l.kt)("p",null,"In a ",(0,l.kt)("inlineCode",{parentName:"p"},"fnfile"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"do"),' represents a series of "steps" (of which there are several types), steps in ',(0,l.kt)("inlineCode",{parentName:"p"},"do")," are run serially. ",(0,l.kt)("inlineCode",{parentName:"p"},"parallel")," is another step type, similar to ",(0,l.kt)("inlineCode",{parentName:"p"},"do"),", except it runs steps in, you guessed it, parallel."),(0,l.kt)("p",null,"But what about ",(0,l.kt)("inlineCode",{parentName:"p"},"matrix"),"?"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Matrix")," is both a ",(0,l.kt)("inlineCode",{parentName:"p"},"step")," type as well as a ",(0,l.kt)("inlineCode",{parentName:"p"},"fn")," modifier. It's an advanced feature of ",(0,l.kt)("inlineCode",{parentName:"p"},"fn")," that allows for the creation of ",(0,l.kt)("em",{parentName:"p"},"virtual")," ",(0,l.kt)("inlineCode",{parentName:"p"},"fns")," based on the matrix. If the ",(0,l.kt)("inlineCode",{parentName:"p"},"parent")," (e.g. ",(0,l.kt)("inlineCode",{parentName:"p"},"build"),") is called, it will in turn, run the children (e.g. ",(0,l.kt)("inlineCode",{parentName:"p"},"build:linux"),"), by default serially, similar to that of the default behavior of ",(0,l.kt)("inlineCode",{parentName:"p"},"fn")," (via ",(0,l.kt)("inlineCode",{parentName:"p"},"do"),"). The names of the children are calculated based on the matrix values. For more information on ",(0,l.kt)("inlineCode",{parentName:"p"},"matrix"),", see the ",(0,l.kt)("a",{parentName:"p",href:"/api/steps/#matrix"},"Matrix Step API"),". The children can be run individually as well either from the CLI or from other ",(0,l.kt)("inlineCode",{parentName:"p"},"fns"),"."),(0,l.kt)("h4",{id:"variable-assignments--use"},"Variable Assignments & Use"),(0,l.kt)("p",null,"A few points more are taken off for the ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile")," for the following, which I barely noticed and actually had to update the example ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile")," to use the proper assignment operator (",(0,l.kt)("inlineCode",{parentName:"p"},":="),"):"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.gnu.org/software/make/manual/html_node/Flavors.html#Flavors"},"Variable flavors")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"=")," a.k.a. ",(0,l.kt)("inlineCode",{parentName:"li"},"recursive expansion")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},":=")," a.k.a. ",(0,l.kt)("inlineCode",{parentName:"li"},"simply expanded variables")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"?=")," a.k.a. ",(0,l.kt)("inlineCode",{parentName:"li"},"conditional variable assignment"))),(0,l.kt)("p",null,"I think the ",(0,l.kt)("inlineCode",{parentName:"p"},"conditional")," assignment operator makes some sense, because ",(0,l.kt)("inlineCode",{parentName:"p"},"?"),' signifies in some minor way a question. So it\'s not hard for me to come to the conclusion of "set if not already set". The other 2 assignment operators are confusing, and I would argue that the most common use case should also be the simplest. ',(0,l.kt)("inlineCode",{parentName:"p"},"simply expanded")," assignment is that use case, but it requires an extra character (",(0,l.kt)("inlineCode",{parentName:"p"},":"),")."),(0,l.kt)("h4",{id:"error-handling"},"Error Handling"),(0,l.kt)("p",null,"Can you spot what's going on, and what the behavior is?"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"clean:\n    -rm -f ${TEST_REPORT}\n")),(0,l.kt)("p",null,"It's the ",(0,l.kt)("inlineCode",{parentName:"p"},"-")," prefix to ",(0,l.kt)("inlineCode",{parentName:"p"},"rm"),". Here is ",(0,l.kt)("a",{parentName:"p",href:"https://web.mit.edu/gnu/doc/html/make_5.html#SEC46"},"the documentation"),'. This means "continue on error". I\'m now curious how you would combine ',(0,l.kt)("a",{parentName:"p",href:"https://web.mit.edu/gnu/doc/html/make_5.html#SEC43"},(0,l.kt)("inlineCode",{parentName:"a"},"@"))," and ",(0,l.kt)("inlineCode",{parentName:"p"},"-")," prefixes..."),(0,l.kt)("p",null,"Regardless, this ",(0,l.kt)("em",{parentName:"p"},"looks")," like a syntax error to me, which should speak for itself regarding poor design for the sake of a more concise syntax."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Taskfile")," is a lot better with an ",(0,l.kt)("a",{parentName:"p",href:"https://taskfile.dev/usage/#ignore-errors"},(0,l.kt)("inlineCode",{parentName:"a"},"ignore_error"))," field that's settable at both the ",(0,l.kt)("inlineCode",{parentName:"p"},"task")," level as well as for each individual item in ",(0,l.kt)("inlineCode",{parentName:"p"},"cmds"),". But even the documentation points out a pitfall:"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("inlineCode",{parentName:"p"},"ignore_error")," can also be set for a task, which means errors will be suppressed for all commands/ Nevertheless, keep in mind that this option will not propagate to other tasks called either by ",(0,l.kt)("inlineCode",{parentName:"p"},"deps")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"cmds"),"!")),(0,l.kt)("p",null,"As of this writing, I'm still not sure if declaring ",(0,l.kt)("inlineCode",{parentName:"p"},"ignore_error")," for each individual item is sufficient or not:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"cmds:\n- task: fail\n  ignore_error: true\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"fn")," actually takes a similar approach to ",(0,l.kt)("inlineCode",{parentName:"p"},"Go"),", in that error handling should be explicit. The ",(0,l.kt)("em",{parentName:"p"},"default")," behavior is very similar to the following code:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-go"},'cmd := "do-something-that-fails"\nerr := Sh(cmd)\nif err != nil {\n   return fmt.Errorf("sh: %s: %w", cmd, err)\n}\n')),(0,l.kt)("p",null,"Providing a bit of context about the error that occurred (similar to that of a stack trace). Even better error handling is also on the roadmap."),(0,l.kt)("p",null,"By providing ",(0,l.kt)("inlineCode",{parentName:"p"},"onError: continue")," instead of just using a ",(0,l.kt)("inlineCode",{parentName:"p"},"boolean")," (",(0,l.kt)("inlineCode",{parentName:"p"},"true|false"),") value, it allows me to expand behavior over time, similar to how this is possible when writing ",(0,l.kt)("inlineCode",{parentName:"p"},"Go")," natively."),(0,l.kt)("h3",{id:"maintainability"},"Maintainability"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile")," has a lot of repetition, and the limitations/design of ",(0,l.kt)("inlineCode",{parentName:"p"},"make"),' would likely cause a degradation of readability in order to achieve a more "DRY" result, and you may see this in later examples.'),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"Taskfile")," also has a lot of repetition, due to the fact that it's written in ",(0,l.kt)("inlineCode",{parentName:"p"},"yaml"),", and yaml has some extra requirements."),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"fnfile"),", also yaml, gains the advantage over the ",(0,l.kt)("inlineCode",{parentName:"p"},"Taskfile")," because of the ",(0,l.kt)("inlineCode",{parentName:"p"},"matrix")," feature, which allows for ",(0,l.kt)("inlineCode",{parentName:"p"},"build:*")," tasks to be collapsed into a single entity. Additionally, a few extra lines are saved by allowing ",(0,l.kt)("inlineCode",{parentName:"p"},"do")," to be ",(0,l.kt)("a",{parentName:"p",href:"/api/steps/#shortcuts"},"represented by a single string")," (instead of an array)."),(0,l.kt)("h3",{id:"lines-of-code"},"Lines of code"),(0,l.kt)("p",null,"With the ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile")," coming in at ",(0,l.kt)("inlineCode",{parentName:"p"},"61"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"Taskfile.yml")," at ",(0,l.kt)("inlineCode",{parentName:"p"},"91"),", and ",(0,l.kt)("inlineCode",{parentName:"p"},"fnfile.yml")," at ",(0,l.kt)("inlineCode",{parentName:"p"},"68"),", the winner here is the ",(0,l.kt)("inlineCode",{parentName:"p"},"Makefile"),". This example is a fairly simple example, I think the gap will widen in later examples."),(0,l.kt)("h2",{id:"conclusion"},"Conclusion"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"fn")," steps provide strong signifiers in the form of ",(0,l.kt)("inlineCode",{parentName:"p"},"do")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"parallel"),", allowing the user to form a mental model of the expected behavior without requiring a manual. Additionally, an ",(0,l.kt)("inlineCode",{parentName:"p"},"fn")," only has a top-level ",(0,l.kt)("inlineCode",{parentName:"p"},"do"),", where all other steps are defined as well, which helps to inform the user of the order in which things will run. In later examples, we'll dig more into parallelism, how it can be described and controlled."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"fn")," makes variables clear and concise. In later examples, we'll get more into tricky situations when it comes to variable evaluation ordering."),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://peps.python.org/pep-0020/"},(0,l.kt)("inlineCode",{parentName:"a"},"fn")," never ignores errors unless they are ",(0,l.kt)("em",{parentName:"a"},"explicitly")," silenced.")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:"left"},"Criteria"),(0,l.kt)("th",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"th"},"make")),(0,l.kt)("th",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"th"},"task")),(0,l.kt)("th",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"th"},"fn")),(0,l.kt)("th",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"th"},"winner")))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"clarity"),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)(R,{mdxType:"LowRating"})),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)(N,{mdxType:"MidRating"})),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)(g,{mdxType:"HighRating"})),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"td"},"fn"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"maintainability"),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)(R,{mdxType:"LowRating"})),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)(N,{mdxType:"MidRating"})),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)(g,{mdxType:"HighRating"})),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"td"},"fn"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:"left"},"lines"),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"td"},"61")),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"td"},"90")),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"td"},"68")),(0,l.kt)("td",{parentName:"tr",align:"left"},(0,l.kt)("inlineCode",{parentName:"td"},"make"))))))}v.isMDXComponent=!0}}]);